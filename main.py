# íŒŒì¼ëª…: safetrip_app_v6.py
import streamlit as st
import random
import pandas as pd

st.set_page_config(
Â  Â  page_title="SafeTrip: ì—¬í–‰ ì•ˆì „ ë³´ê³ ì„œ (V6)",Â 
Â  Â  page_icon="âœˆï¸",Â 
Â  Â  layout="wide"
)
st.title("âœˆï¸ SafeTrip: ì—¬í–‰ ì•ˆì „ ë³´ê³ ì„œ ë° ì ê²€ (ìµœì¢… ì•ˆì •í™”)")
st.markdown("ì—¬í–‰í•  **êµ­ê°€**ì™€ **ë„ì‹œ**ë¥¼ ì„ íƒí•˜ê³  **'ì•ˆì „ ë³´ê³ ì„œ ê²€ìƒ‰'** ë²„íŠ¼ì„ ëˆŒëŸ¬ ë§ì¶¤í˜• ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.")
st.markdown("---")

# --- 1. ìƒ˜í”Œ ë°ì´í„° í™•ì¥ (ì¶”ì²œ ëª…ì†Œ/í•«í”Œ ì •ë³´ ì¶”ê°€) ---
safety_data = {
Â  Â  # ì•„ì‹œì•„/ì˜¤ì„¸ì•„ë‹ˆì•„ (ì´ 10ê°œêµ­)
Â  Â  "í•œêµ­": {"ë„ì‹œ": ["ì„œìš¸", "ë¶€ì‚°", "ì œì£¼", "ì¸ì²œ", "ëŒ€êµ¬", "ëŒ€ì „", "ê´‘ì£¼", "ìš¸ì‚°"], "ìœ„í—˜ ì •ë³´": ["ì¹˜ì•ˆ: ëŒ€ì²´ë¡œ ì•ˆì „", "êµí†µ: ì¶œí‡´ê·¼ ì‹œê°„ í˜¼ì¡"], "ëŒ€ì²˜ ìš”ë ¹": ["ëŒ€ì¤‘êµí†µ ì´ìš© ê¶Œì¥"], "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "112 (ê²½ì°°), 119 (êµ¬ê¸‰/ì†Œë°©)"}, "ì¶”ì²œ": {"ëª…ì†Œ": ["ê²½ë³µê¶", "ë‚¨ì‚°íƒ€ì›Œ"], "ë§›ì§‘": ["ê´‘ì¥ì‹œì¥", "ëª…ë™êµì"], "í•«í”Œ": ["í™ëŒ€", "ì„±ìˆ˜ë™"]}},
Â  Â  "ì¼ë³¸": {"ë„ì‹œ": ["ë„ì¿„", "ì˜¤ì‚¬ì¹´", "í›„ì¿ ì˜¤ì¹´", "ì‚¿í¬ë¡œ", "ë‚˜ê³ ì•¼", "êµí† ", "ìš”ì½”í•˜ë§ˆ"], "ìœ„í—˜ ì •ë³´": ["ìì—°ì¬í•´: ì§€ì§„ ê°€ëŠ¥ì„±", "ì¹˜ì•ˆ: ìœ í¥ê°€ í˜¸ê°í–‰ìœ„ ì£¼ì˜"], "ëŒ€ì²˜ ìš”ë ¹": ["ì§€ì§„ ë°œìƒ ì‹œ 'DROP, COVER, HOLD ON' ê¸°ì–µ"], "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "110 (ê²½ì°°), 119 (êµ¬ê¸‰/ì†Œë°©)"}, "ì¶”ì²œ": {"ëª…ì†Œ": ["í›„ì§€ì‚°", "ë„ì¿„ íƒ€ì›Œ"], "ë§›ì§‘": ["ë¼ë©˜ ê³¨ëª©", "ì˜¤ì½”ë…¸ë¯¸ì•¼í‚¤"], "í•«í”Œ": ["ì‹œë¶€ì•¼", "ì‹ ì£¼ì¿ "]}},
Â  Â  "íƒœêµ­": {"ë„ì‹œ": ["ë°©ì½•", "ì¹˜ì•™ë§ˆì´", "í‘¸ì¼“", "íŒŒíƒ€ì•¼", "ë„ë¼ë¹„", "ì½”ì‚¬ë¬´ì´"], "ìœ„í—˜ ì •ë³´": ["ì¹˜ì•ˆ: ê´€ê´‘ì§€ ì†Œë§¤ì¹˜ê¸° ì£¼ì˜", "êµí†µ: íˆ­íˆ­ ì´ìš© ì‹œ ê°€ê²© í¥ì • í•„ìˆ˜"], "ëŒ€ì²˜ ìš”ë ¹": ["ì •ë¶€ ê³µì¸ëœ íƒì‹œ ì•± ì‚¬ìš©"], "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "191 (ê²½ì°°), 1669 (ì•°ë·¸ëŸ°ìŠ¤)"}, "ì¶”ì²œ": {"ëª…ì†Œ": ["ì™“ ì•„ë£¬", "ì™•ê¶"], "ë§›ì§‘": ["ì¹´ì˜¤ì‚° ë¡œë“œ ë…¸ì ", "íŒŸíƒ€ì´"], "í•«í”Œ": ["ë£¨í”„íƒ‘ ë°”", "í´ëŸ½"]}},
Â  Â  "ë² íŠ¸ë‚¨": {"ë„ì‹œ": ["í•˜ë…¸ì´", "í˜¸ì°Œë¯¼", "ë‹¤ë‚­", "ë‚˜íŠ¸ë‘", "í‘¸ê¾¸ì˜¥", "í˜¸ì´ì•ˆ"], "ìœ„í—˜ ì •ë³´": ["êµí†µ: ì˜¤í† ë°”ì´ êµí†µëŸ‰ ë§¤ìš° ë§ìŒ", "ì¹˜ì•ˆ: í•¸ë“œí° ë‚ ì¹˜ê¸° ì£¼ì˜"], "ëŒ€ì²˜ ìš”ë ¹": ["ê¸¸ê±°ë¦¬ ê±¸ì„ ë•Œ ì†Œì§€í’ˆ ë³´í˜¸ ì² ì €"], "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "113 (ê²½ì°°), 115 (ì•°ë·¸ëŸ°ìŠ¤)"}, "ì¶”ì²œ": {"ëª…ì†Œ": ["í•˜ë¡±ë² ì´", "í˜¸ì´ì•ˆ êµ¬ì‹œê°€ì§€"], "ë§›ì§‘": ["ìŒ€êµ­ìˆ˜", "ë°˜ë¯¸"], "í•«í”Œ": ["ì¹´í˜ê±°ë¦¬", "ë¹„ì–´í—"]}},
Â  Â  "ìº„ë³´ë””ì•„": {"ë„ì‹œ": ["í”„ë†ˆíœ", "ì‹œì— ë¦½", "ì‹œì•„ëˆ„í¬ë¹Œ"], "ìœ„í—˜ ì •ë³´": ["ì¹˜ì•ˆ: ì ˆë„ ë°œìƒ ì¦ê°€", "ì§ˆë³‘: ë…ê¸°ì—´ ëª¨ê¸° ì£¼ì˜"], "ëŒ€ì²˜ ìš”ë ¹": ["ì•¼ê°„ ì™¸ì¶œ ì‹œ íƒì‹œ ì´ìš©"], "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "117 (ê²½ì°°), 119 (ì•°ë·¸ëŸ°ìŠ¤)"}, "ì¶”ì²œ": {"ëª…ì†Œ": ["ì•™ì½”ë¥´ì™€íŠ¸"], "ë§›ì§‘": ["ì•„ëª©", "ë¡ë½"], "í•«í”Œ": ["í ìŠ¤íŠ¸ë¦¬íŠ¸"]}},
Â  Â  "í•„ë¦¬í•€": {"ë„ì‹œ": ["ë§ˆë‹ë¼", "ì„¸ë¶€", "ë³´ë¼ì¹´ì´", "íŒ”ë¼ì™„"], "ìœ„í—˜ ì •ë³´": ["ì¹˜ì•ˆ: í…ŒëŸ¬ ìœ„í—˜ ì§€ì—­ ì¡´ì¬", "ìì—°ì¬í•´: íƒœí’/ì§€ì§„/í™”ì‚° í™œë™ ì£¼ì˜"], "ëŒ€ì²˜ ìš”ë ¹": ["ì™¸êµë¶€ ì—¬í–‰ê²½ë³´ í™•ì¸ í•„ìˆ˜"], "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "911 (ê²½ì°°/êµ¬ê¸‰/ì†Œë°©)"}, "ì¶”ì²œ": {"ëª…ì†Œ": ["ì´ˆì½œë¦¿ í"], "ë§›ì§‘": ["ë ˆì´Œ", "í• ë¡œí• ë¡œ"], "í•«í”Œ": ["í™”ì´íŠ¸ ë¹„ì¹˜"]}},
Â  Â  "ì¸ë„ë„¤ì‹œì•„": {"ë„ì‹œ": ["ìì¹´ë¥´íƒ€", "ë°œë¦¬", "ë¡¬ë³µ", "ìš•ì•¼ì¹´ë¥´íƒ€"], "ìœ„í—˜ ì •ë³´": ["ìì—°ì¬í•´: í™”ì‚° í™œë™ ë° ì“°ë‚˜ë¯¸ ê°€ëŠ¥ì„±", "êµí†µ: ë¬´ë©´í—ˆ ìš´ì „ ìœ„í—˜"], "ëŒ€ì²˜ ìš”ë ¹": ["í˜„ì§€ íƒì‹œ ëŒ€ì‹  ê²€ì¦ëœ êµí†µìˆ˜ë‹¨ ì´ìš©"], "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "110 (ê²½ì°°), 118 (ì•°ë·¸ëŸ°ìŠ¤)"}, "ì¶”ì²œ": {"ëª…ì†Œ": ["ìš°ë¶“ ì›ìˆ­ì´ ìˆ²", "ë³´ë¡œë¶€ë‘ë¥´ ì‚¬ì›"], "ë§›ì§‘": ["ë‚˜ì‹œ ê³ ë­"], "í•«í”Œ": ["ìŠ¤ë¯¸ëƒ‘"]}},
Â  Â  "í˜¸ì£¼": {"ë„ì‹œ": ["ì‹œë“œë‹ˆ", "ë©œë²„ë¥¸", "ë¸Œë¦¬ì¦ˆë²ˆ", "í¼ìŠ¤", "ì• ë“¤ë ˆì´ë“œ"], "ìœ„í—˜ ì •ë³´": ["ìì—°ì¬í•´: ì‚°ë¶ˆ ë° í­ìš°", "í™˜ê²½: ë…ì„± ìƒë¬¼ ì£¼ì˜"], "ëŒ€ì²˜ ìš”ë ¹": ["ì—¬í–‰ ì‹œ ì•¼ìƒë™ë¬¼ê³¼ì˜ ì ‘ì´‰ ìì œ"], "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "000 (ê²½ì°°/êµ¬ê¸‰/ì†Œë°©)"}, "ì¶”ì²œ": {"ëª…ì†Œ": ["ì˜¤í˜ë¼ í•˜ìš°ìŠ¤", "ê·¸ë ˆì´íŠ¸ ì˜¤ì…˜ ë¡œë“œ"], "ë§›ì§‘": ["ë¯¸íŠ¸ íŒŒì´"], "í•«í”Œ": ["ë‹¬ë§ í•˜ë²„"]}},
Â  Â  "ë¯¸êµ­": {"ë„ì‹œ": ["ë‰´ìš•", "LA", "ìƒŒí”„ë€ì‹œìŠ¤ì½”", "ì‹œì¹´ê³ ", "ë§ˆì´ì• ë¯¸", "ë¼ìŠ¤ë² ì´ê±°ìŠ¤", "í•˜ì™€ì´"], "ìœ„í—˜ ì •ë³´": ["ì¹˜ì•ˆ: ë„ì‹¬ ì¼ë¶€ ì§€ì—­ ë²”ì£„ìœ¨ ë†’ìŒ", "ë²•ê·œ: ì´ê¸° ì‚¬ê³  ì£¼ì˜"], "ëŒ€ì²˜ ìš”ë ¹": ["ì•¼ê°„ì—ëŠ” ì¸ì ì´ ë“œë¬¸ ê³³ í”¼í•˜ê¸°"], "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "911 (ê²½ì°°/êµ¬ê¸‰/ì†Œë°©)"}, "ì¶”ì²œ": {"ëª…ì†Œ": ["ììœ ì˜ ì—¬ì‹ ìƒ", "ê·¸ëœë“œ ìºë‹ˆì–¸"], "ë§›ì§‘": ["ì¸ì•¤ì•„ì›ƒ ë²„ê±°"], "í•«í”Œ": ["íƒ€ì„ìŠ¤í€˜ì–´"]}},
Â  Â  "í”„ë‘ìŠ¤": {"ë„ì‹œ": ["íŒŒë¦¬", "ë‹ˆìŠ¤", "ë§ˆë¥´ì„¸ìœ ", "ë¦¬ì˜¹"], "ìœ„í—˜ ì •ë³´": ["ì¹˜ì•ˆ: ê´€ê´‘ì§€ ì†Œë§¤ì¹˜ê¸° ì„±í–‰", "ì‹œìœ„: ë…¸ë™ì¡°í•© ë° ì •ì¹˜ì  ì‹œìœ„ ë¹ˆë²ˆ"], "ëŒ€ì²˜ ìš”ë ¹": ["ì‹œìœ„ êµ¬ì—­ íšŒí”¼"], "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "17 (ê²½ì°°), 15 (ì•°ë·¸ëŸ°ìŠ¤)"}, "ì¶”ì²œ": {"ëª…ì†Œ": ["ì—í íƒ‘", "ë£¨ë¸Œë¥´ ë°•ë¬¼ê´€"], "ë§›ì§‘": ["í¬ë£¨ì•„ìƒ", "ë§ˆì¹´ë¡±"], "í•«í”Œ": ["ë§ˆë ˆ ì§€êµ¬"]}},
Â  Â  "ì´íƒˆë¦¬ì•„": {"ë„ì‹œ": ["ë¡œë§ˆ", "ë°€ë¼ë…¸", "í”¼ë Œì²´", "ë² ë„¤ì¹˜ì•„", "ë‚˜í´ë¦¬"], "ìœ„í—˜ ì •ë³´": ["ì¹˜ì•ˆ: ì§‘ì‹œ ë° ë‹¤ì¤‘ì‹œì„¤ ì†Œë§¤ì¹˜ê¸° ì£¼ì˜", "í™˜ê²½: ê´€ê´‘ì§€ ì£¼ë³€ ì‚¬ê¸°ê¾¼ ì£¼ì˜"], "ëŒ€ì²˜ ìš”ë ¹": ["ê°€ë°©ì€ ëª¸ ì•ìœ¼ë¡œ ë©”ê¸°"], "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "112 (ê²½ì°°/êµ¬ê¸‰/ì†Œë°©)"}, "ì¶”ì²œ": {"ëª…ì†Œ": ["ì½œë¡œì„¸ì›€", "ë‘ì˜¤ëª¨ ì„±ë‹¹"], "ë§›ì§‘": ["íŒŒìŠ¤íƒ€", "ì ¤ë¼ë˜"], "í•«í”Œ": ["íŠ¸ë ˆë¹„ ë¶„ìˆ˜"]}},
Â  Â  "ìŠ¤í˜ì¸": {"ë„ì‹œ": ["ë°”ë¥´ì…€ë¡œë‚˜", "ë§ˆë“œë¦¬ë“œ", "ì„¸ë¹„ì•¼", "ë°œë Œì‹œì•„"], "ìœ„í—˜ ì •ë³´": ["ì¹˜ì•ˆ: ë‹¤ë°œì„± ì†Œë§¤ì¹˜ê¸°", "ë²•ê·œ: ê±°ë¦¬ì—ì„œ í¡ì—° ê·œì œ ì—„ê²©"], "ëŒ€ì²˜ ìš”ë ¹": ["ì§€ì •ëœ í¡ì—° êµ¬ì—­ ì´ìš©"], "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "112 (ê²½ì°°/êµ¬ê¸‰/ì†Œë°©)"}, "ì¶”ì²œ": {"ëª…ì†Œ": ["ì‚¬ê·¸ë¼ë‹¤ íŒŒë°€ë¦¬ì•„", "ì•ŒëŒë¸Œë¼"], "ë§›ì§‘": ["ë¹ ì—ì•¼", "ì¸„ëŸ¬ìŠ¤"], "í•«í”Œ": ["ëŒë¸”ë¼ìŠ¤ ê±°ë¦¬"]}},
}

# ì—¬í–‰ ì „ í•„ìˆ˜ ì ê²€ ë¦¬ìŠ¤íŠ¸
check_list = [
Â  Â  "ì—¬ê¶Œ/ë¹„ì ìœ íš¨ ê¸°ê°„ í™•ì¸",
Â  Â  "ì—¬í–‰ì ë³´í—˜ ê°€ì… ì™„ë£Œ",
Â  Â  "í˜„ì§€ ê¸´ê¸‰ ì—°ë½ì²˜ ì €ì¥",
Â  Â  "ì‹ ìš©ì¹´ë“œ ë¶„ì‹¤ ì‹ ê³ ì²˜ ë©”ëª¨",
Â  Â  "ì—¬í–‰ì§€ ë‚ ì”¨ ë° ë³µì¥ í™•ì¸",
Â  Â  "ìƒë¹„ì•½(í•´ì—´ì œ, ì†Œí™”ì œ ë“±) ì¤€ë¹„"
]

# --- 2. ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™” ë° ê´€ë¦¬ ---

if "selected_country" not in st.session_state:
Â  Â  st.session_state.selected_country = "í•œêµ­"Â 
if "selected_city" not in st.session_state:
Â  Â  st.session_state.selected_city = "ì„œìš¸"
if "checklist_status" not in st.session_state:
Â  Â  st.session_state.checklist_status = {item: False for item in check_list}
if "report_searched" not in st.session_state:
Â  Â  st.session_state.report_searched = False
if "balloons_shown" not in st.session_state: # í’ì„  ì œì–´ í”Œë˜ê·¸
Â  Â  st.session_state.balloons_shown = False


# --- 3. ì‚¬ìš©ì ì…ë ¥ ì„¹ì…˜ (ì„ íƒ í›„ ê²€ìƒ‰ ë°©ì‹) ---

st.subheader("ğŸ“ ì•ˆì „ ë³´ê³ ì„œ ìƒì„±")

col_country, col_city = st.columns(2)

# 1. êµ­ê°€ ì„ íƒ
with col_country:
Â  Â  def update_city_on_country_change():
Â  Â  Â  Â  # êµ­ê°€ê°€ ë³€ê²½ë  ë•Œ ë„ì‹œ ì„ íƒê°’ì„ ë¦¬ì…‹
Â  Â  Â  Â  country_key = st.session_state.country_select
Â  Â  Â  Â  current_cities = safety_data.get(country_key, {}).get("ë„ì‹œ", [])
Â  Â  Â  Â  if current_cities:
Â  Â  Â  Â  Â  Â  st.session_state.selected_city = current_cities[0]
Â  Â  Â  Â  else:
Â  Â  Â  Â  Â  Â  st.session_state.selected_city = "ì •ë³´ ì—†ìŒ"
Â  Â  Â  Â  st.session_state.selected_country = country_key
Â  Â  Â  Â  st.session_state.report_searched = False # ê²€ìƒ‰ ìƒíƒœ í•´ì œ
Â  Â  Â  Â  st.session_state.balloons_shown = False # í’ì„  ìƒíƒœ ë¦¬ì…‹

Â  Â  st.selectbox(
Â  Â  Â  Â  "â‘  ì—¬í–‰í•  êµ­ê°€ ì„ íƒ ğŸŒ",Â 
Â  Â  Â  Â  list(safety_data.keys()),Â 
Â  Â  Â  Â  index=list(safety_data.keys()).index(st.session_state.selected_country),
Â  Â  Â  Â  key="country_select",
Â  Â  Â  Â  on_change=update_city_on_country_changeÂ 
Â  Â  )

# 2. ë„ì‹œ ì„ íƒ
with col_city:
Â  Â  current_cities = safety_data.get(st.session_state.selected_country, {}).get("ë„ì‹œ", [])
Â  Â Â 
Â  Â  if st.session_state.selected_city not in current_cities and current_cities:
Â  Â  Â  Â  st.session_state.selected_city = current_cities[0]
Â  Â  elif not current_cities:
Â  Â  Â  Â  st.session_state.selected_city = "ì •ë³´ ì—†ìŒ"

Â  Â  st.selectbox(
Â  Â  Â  Â  "â‘¡ ì—¬í–‰í•  ë„ì‹œ ì„ íƒ ğŸ™ï¸",
Â  Â  Â  Â  current_cities,
Â  Â  Â  Â  index=current_cities.index(st.session_state.selected_city) if st.session_state.selected_city in current_cities else 0,
Â  Â  Â  Â  key="city_select",
Â  Â  Â  Â  on_change=lambda: st.session_state.update(selected_city=st.session_state.city_select, report_searched=False) # ì„ íƒ ì‹œ ê²€ìƒ‰ ìƒíƒœ í•´ì œ
Â  Â  )

col_btn1, col_btn2 = st.columns([1.5, 3])
with col_btn1:
Â  Â  if st.button("ì•ˆì „ ë³´ê³ ì„œ ê²€ìƒ‰", type="primary", use_container_width=True):
Â  Â  Â  Â  st.session_state.report_searched = True
Â  Â  Â  Â  st.rerun()

st.markdown("---")

# --- 4. ì•ˆì „ ë³´ê³ ì„œ ì„¹ì…˜ (ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ í›„ì—ë§Œ ë‚˜íƒ€ë‚¨) ---

selected_country = st.session_state.selected_country
selected_city = st.session_state.selected_city
country_info = safety_data.get(selected_country)

if st.session_state.report_searched:
Â  Â Â 
Â  Â  if not country_info:
Â  Â  Â  Â  st.error(f"âŒ **{selected_country}**ì— ëŒ€í•œ ìƒì„¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ëª©ë¡ì—ì„œ ë‹¤ë¥¸ êµ­ê°€ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.")
Â  Â  Â  Â  country_info = {"ìœ„í—˜ ì •ë³´": ["ìƒì„¸ ì •ë³´ ì—†ìŒ. ì¼ë°˜ ì•ˆì „ ìˆ˜ì¹™ ì¤€ìˆ˜."],Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "ëŒ€ì²˜ ìš”ë ¹": ["ì¼ë°˜ ì•ˆì „ ìˆ˜ì¹™ í™•ì¸."],Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "í˜„ì§€ ì—°ë½ì²˜": {"ê¸´ê¸‰ ì „í™”": "í˜„ì§€ ê¸´ê¸‰ ì—°ë½ì²˜ ê²€ìƒ‰ í•„ìš”"},
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "ì¶”ì²œ": {"ëª…ì†Œ": ["ì •ë³´ ì—†ìŒ"], "ë§›ì§‘": ["ì •ë³´ ì—†ìŒ"], "í•«í”Œ": ["ì •ë³´ ì—†ìŒ"]}}

Â  Â  st.header(f"ğŸ” **{selected_city}, {selected_country}** ì•ˆì „ ë³´ê³ ì„œ")
Â  Â Â 
Â  Â  # ìƒˆë¡œìš´ íƒ­ ì¶”ê°€: 'ì¶”ì²œ ëª…ì†Œ'
Â  Â  tab1, tab2, tab3, tab4, tab5 = st.tabs(["âš ï¸ ìœ„í—˜ ì •ë³´", "âœ… ëŒ€ì²˜ ìš”ë ¹", "ğŸ“ í˜„ì§€ ì—°ë½ì²˜", "ğŸ“ ì—¬í–‰ ì „ ì ê²€", "âœ¨ ì¶”ì²œ ëª…ì†Œ/í•«í”Œ"])

Â  Â  with tab1:
Â  Â  Â  Â  st.subheader("âš ï¸ ì£¼ìš” ì•ˆì „ ìœ„í—˜ ë° ìœ ì˜ ì‚¬í•­")
Â  Â  Â  Â  for risk in country_info["ìœ„í—˜ ì •ë³´"]:
Â  Â  Â  Â  Â  Â  st.warning(f"**{risk}**")
Â  Â  Â  Â  st.markdown("---")
Â  Â  Â  Â Â 
Â  Â  Â  Â  st.markdown("#### ğŸ“° **í˜„ì§€ ì•ˆì „ ì´ìŠˆ ê²€ìƒ‰**")
Â  Â  Â  Â  st.info("ğŸ’¡ ìµœê·¼ ë°œìƒí•œ ì‚¬ê³ ë‚˜ ë‰´ìŠ¤ëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€ë™ë©ë‹ˆë‹¤. ì•„ë˜ ë²„íŠ¼ì„ ì´ìš©í•´ ì§ì ‘ í™•ì¸í•´ ë³´ì„¸ìš”.")
Â  Â  Â  Â  search_query = f"{selected_country} {selected_city} ìµœê·¼ ì•ˆì „ ì‚¬ê³ "
Â  Â  Â  Â  st.link_button(
Â  Â  Â  Â  Â  Â  f"êµ¬ê¸€ì—ì„œ '{selected_city} ì•ˆì „ ì‚¬ê³ ' ê²€ìƒ‰í•˜ê¸°",Â 
Â  Â  Â  Â  Â  Â  f"https://www.google.com/search?q={search_query}",
Â  Â  Â  Â  Â  Â  use_container_width=True
Â  Â  Â  Â  )
Â  Â  Â  Â Â 

Â  Â  with tab2:
Â  Â  Â  Â  st.subheader("âœ… ìœ„í—˜ ìƒí™©ë³„ í–‰ë™ ìš”ë ¹")
Â  Â  Â  Â  for tip in country_info["ëŒ€ì²˜ ìš”ë ¹"]:
Â  Â  Â  Â  Â  Â  st.success(f"**{tip}**")
Â  Â  Â  Â Â 
Â  Â  Â  Â  st.markdown("---")
Â  Â  Â  Â  st.markdown("#### ğŸš¨ ì¼ë°˜ ê¸´ê¸‰ ìƒí™© ëŒ€ì²˜ë²•")
Â  Â  Â  Â  st.markdown("""
Â  Â  Â  Â  * **ë„ë‚œ/ë¶„ì‹¤:** ì¦‰ì‹œ ê²½ì°° ì‹ ê³  ë° ì˜ì‚¬ê´€ì— ì—°ë½. ì‹ ìš©ì¹´ë“œ ì •ì§€.
Â  Â  Â  Â  * **ìì—°ì¬í•´:** í˜„ì§€ ì¬ë‚œ ë°©ì†¡ ì²­ì·¨, ëŒ€í”¼ì†Œë¡œ ì´ë™.
Â  Â  Â  Â  """)
Â  Â  Â  Â Â 
Â  Â  with tab3:
Â  Â  Â  Â  st.subheader("ğŸ“ í˜„ì§€ í•„ìˆ˜ ë¹„ìƒ ì—°ë½ë§ ë° ë©”ëª¨")
Â  Â  Â  Â  contact = country_info["í˜„ì§€ ì—°ë½ì²˜"]
Â  Â  Â  Â Â 
Â  Â  Â  Â  st.markdown(f"""
Â  Â  Â  Â  * **ğŸš¨ í˜„ì§€ ê¸´ê¸‰ ì „í™” (ê²½ì°°/ì†Œë°©/ì•°ë·¸ëŸ°ìŠ¤):** **{contact.get("ê¸´ê¸‰ ì „í™”", "ì •ë³´ ì—†ìŒ")}**
Â  Â  Â  Â  * **ğŸ‡°ğŸ‡· ì£¼ {selected_country} ëŒ€í•œë¯¼êµ­ ëŒ€ì‚¬ê´€/ì˜ì‚¬ê´€:** (ì™¸êµë¶€ ì‚¬ì´íŠ¸ì—ì„œ ì§ì ‘ ê²€ìƒ‰ í›„ ë©”ëª¨í•˜ì„¸ìš”.)
Â  Â  Â  Â  """)
Â  Â  Â  Â Â 
Â  Â  Â  Â  st.text_area(
Â  Â  Â  Â  Â  Â  "ëŒ€ì‚¬ê´€/ì˜ì‚¬ê´€ ì—°ë½ì²˜ ë©”ëª¨",
Â  Â  Â  Â  Â  Â  placeholder="ì˜ˆ: +XX-XXX-XXXX (ì£¼XX ëŒ€ì‚¬ê´€)",
Â  Â  Â  Â  Â  Â  key="embassy_memo"
Â  Â  Â  Â  )
Â  Â  Â  Â  st.info("â˜ï¸ í˜„ì§€ ëŒ€ì‚¬ê´€ ì—°ë½ì²˜ëŠ” [ì™¸êµë¶€ í•´ì™¸ì•ˆì „ì—¬í–‰](https://www.mofa.go.kr/www/index.do) ì‚¬ì´íŠ¸ì—ì„œ **ì§ì ‘ í™•ì¸** í›„ ë©”ëª¨í•´ ë‘ëŠ” ê²ƒì´ ê°€ì¥ ì •í™•í•©ë‹ˆë‹¤.")

Â  Â  with tab4:
Â  Â  Â  Â  st.subheader("ğŸ“ ì—¬í–‰ ì „ í•„ìˆ˜ ì ê²€ ëª©ë¡")
Â  Â  Â  Â  st.markdown("ì•„ë˜ í•­ëª©ì„ ëª¨ë‘ ì™„ë£Œí•˜ì—¬ ì•ˆì „í•œ ì—¬í–‰ì„ ì¤€ë¹„í•˜ì„¸ìš”.")
Â  Â  Â  Â Â 
Â  Â  Â  Â  # ì²´í¬ë¦¬ìŠ¤íŠ¸ í•­ëª© ë Œë”ë§ ë° ìƒíƒœ ì—…ë°ì´íŠ¸
Â  Â  Â  Â  new_checklist_status = {}
Â  Â  Â  Â  for item in check_list:
Â  Â  Â  Â  Â  Â  # ì²´í¬ë°•ìŠ¤ í‚¤ì— êµ­ê°€ë¥¼ í¬í•¨í•˜ì—¬ ë‹¤ë¥¸ êµ­ê°€ë¥¼ ê²€ìƒ‰í•´ë„ ì²´í¬ ìƒíƒœê°€ ìœ ì§€ë˜ì§€ ì•Šë„ë¡ í•¨ (ë‹¤ë¥¸ ë‚˜ë¼ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë¶„ë¦¬)
Â  Â  Â  Â  Â  Â  is_checked = st.checkbox(item, value=st.session_state.checklist_status[item], key=f"check_{item}_{selected_country}")
Â  Â  Â  Â  Â  Â  new_checklist_status[item] = is_checked
Â  Â  Â  Â  st.session_state.checklist_status = new_checklist_status
Â  Â  Â  Â Â 
Â  Â  Â  Â  # ì™„ë£Œ ìƒíƒœ í”¼ë“œë°±
Â  Â  Â  Â  completed_count = sum(st.session_state.checklist_status.values())
Â  Â  Â  Â  total_count = len(check_list)
Â  Â  Â  Â Â 
Â  Â  Â  Â  st.markdown(f"---")
Â  Â  Â  Â  if completed_count == total_count:
Â  Â  Â  Â  Â  Â  # í’ì„  ì œì–´: ì™„ë£Œ ìƒíƒœì´ê³  ì•„ì§ í’ì„ ì´ ë‚˜ì˜¤ì§€ ì•Šì•˜ë‹¤ë©´ ì‹¤í–‰
Â  Â  Â  Â  Â  Â  if not st.session_state.balloons_shown:
Â  Â  Â  Â  Â  Â  Â  Â  st.balloons()
Â  Â  Â  Â  Â  Â  Â  Â  st.session_state.balloons_shown = True # í’ì„ ì´ ë‚˜ì™”ìŒì„ í‘œì‹œ
Â  Â  Â  Â  Â  Â  st.success("ğŸ‰ **ëª¨ë“  ì ê²€ ì™„ë£Œ! ì•ˆì „í•œ ì—¬í–‰ì´ ë  ê±°ì˜ˆìš”!**")
Â  Â  Â  Â  else:
Â  Â  Â  Â  Â  Â  st.warning(f"âš ï¸ **{total_count}ê°œ ì¤‘ {completed_count}ê°œ ì™„ë£Œ.** ë‚¨ì€ í•­ëª©ì„ ë§ˆì € ì ê²€í•˜ì„¸ìš”!")
Â  Â  Â  Â Â 
Â  Â  Â  Â  # --- ì²´í¬ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™” ë²„íŠ¼ ìœ„ì¹˜ ìˆ˜ì • ---
Â  Â  Â  Â  if st.button("ì²´í¬ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”", key="reset_checklist_btn"):
Â  Â  Â  Â  Â  Â  st.session_state.checklist_status = {item: False for item in check_list}
Â  Â  Â  Â  Â  Â  st.toast("ì²´í¬ë¦¬ìŠ¤íŠ¸ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.", icon="ğŸ”„")
Â  Â  Â  Â  Â  Â  st.rerun() # ì´ˆê¸°í™” í›„ í™”ë©´ ê°±ì‹ 


Â  Â  with tab5:
Â  Â  Â  Â  st.subheader(f"âœ¨ {selected_city} ì¶”ì²œ ëª…ì†Œ, ë§›ì§‘, í•«í”Œ")
Â  Â  Â  Â Â 
Â  Â  Â  Â  rec_data = country_info["ì¶”ì²œ"]
Â  Â  Â  Â Â 
Â  Â  Â  Â  col_m, col_b, col_h = st.columns(3)
Â  Â  Â  Â Â 
Â  Â  Â  Â  with col_m:
Â  Â  Â  Â  Â  Â  st.info("ğŸ“Œ **ì¶”ì²œ ëª…ì†Œ**")
Â  Â  Â  Â  Â  Â  for item in rec_data["ëª…ì†Œ"]:
Â  Â  Â  Â  Â  Â  Â  Â  st.markdown(f"â€¢ {item}")
Â  Â  Â  Â Â 
Â  Â  Â  Â  with col_b:
Â  Â  Â  Â  Â  Â  st.info("ğŸ½ï¸ **ì¶”ì²œ ë§›ì§‘**")
Â  Â  Â  Â  Â  Â  for item in rec_data["ë§›ì§‘"]:
Â  Â  Â  Â  Â  Â  Â  Â  st.markdown(f"â€¢ {item}")
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  with col_h:
Â  Â  Â  Â  Â  Â  st.info("ğŸ”¥ **ì¶”ì²œ í•«í”Œë ˆì´ìŠ¤**")
Â  Â  Â  Â  Â  Â  for item in rec_data["í•«í”Œ"]:
Â  Â  Â  Â  Â  Â  Â  Â  st.markdown(f"â€¢ {item}")
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  st.markdown("---")
Â  Â  Â  Â  st.info("ğŸ’¡ ë” ë§ì€ ì •ë³´ë¥¼ ì›í•˜ì‹œë©´ êµ¬ê¸€ì—ì„œ ê²€ìƒ‰í•´ ë³´ì„¸ìš”.")
Â  Â  Â  Â  search_query_trip = f"{selected_country} {selected_city} ì¶”ì²œ ì—¬í–‰ì§€"
Â  Â  Â  Â  st.link_button(
Â  Â  Â  Â  Â  Â  f"êµ¬ê¸€ì—ì„œ '{selected_city} ì¶”ì²œ ëª…ì†Œ' ê²€ìƒ‰í•˜ê¸°",Â 
Â  Â  Â  Â  Â  Â  f"https://www.google.com/search?q={search_query_trip}",
Â  Â  Â  Â  Â  Â  use_container_width=True
Â  Â  Â  Â  )


# --- 5. ë§ˆë¬´ë¦¬ ë° ì¶”ì²œ ì—¬í–‰ì§€ ì¬ë°°ì¹˜ ---

st.markdown("---")
st.subheader("ğŸŒŸ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”! ì¶”ì²œ ì—¬í–‰ì§€ í•«ìŠ¤íŒŸ")
col_rec1, col_rec2, col_rec3 = st.columns(3)

# ì¶”ì²œ ë¡œì§ (ì„ì˜ ì§€ì •)
recommendations = [
Â  Â  ("ë„ì¿„", "ì¼ë³¸", "ì•ˆì „í•œ ì¹˜ì•ˆ, ì§€ì§„ ëŒ€ë¹„ í•„ìˆ˜!"),
Â  Â  ("íŒŒë¦¬", "í”„ë‘ìŠ¤", "ì†Œë§¤ì¹˜ê¸° ì£¼ì˜, ë¬¸í™”ì¬ ì¤‘ì‹¬ ê´€ê´‘"),
Â  Â  ("ë°œë¦¬", "ì¸ë„ë„¤ì‹œì•„", "ìì—°ì¬í•´ ë° êµí†µ í˜¼ì¡ ì£¼ì˜"),
]

for i, (city, country, desc) in enumerate(recommendations):
Â  Â  col = [col_rec1, col_rec2, col_rec3][i]
Â  Â  with col:
Â  Â  Â  Â  st.info(f"**{city} ({country})**", icon="ğŸ“Œ")
Â  Â  Â  Â  st.caption(desc)
Â  Â  Â  Â  if st.button(f"'{city}' ì •ë³´ ë°”ë¡œ ë³´ê¸°", key=f"rec_btn_final_{i}", use_container_width=True):
Â  Â  Â  Â  Â  Â  st.session_state.selected_country = country
Â  Â  Â  Â  Â  Â  st.session_state.selected_city = city
Â  Â  Â  Â  Â  Â  st.session_state.report_searched = True
Â  Â  Â  Â  Â  Â  st.rerun()

st.markdown("---")

col_guide, col_map = st.columns(2)

with col_guide:
Â  Â  st.markdown("### ğŸ—ºï¸ ì§€ë„ ê¸°ëŠ¥ì— ëŒ€í•˜ì—¬")
Â  Â  st.info("ìš”ì²­í•˜ì‹  ëŒ€ë¡œ **ì‹¤ì‹œê°„ ì§€ë„** ëŒ€ì‹  **êµ­ê°€ ì´ë¯¸ì§€ ì§€ë„**ë¡œ ëŒ€ì²´í•˜ì˜€ìŠµë‹ˆë‹¤. ì—¬í–‰ì§€ì˜ ì§€ë¦¬ì  ìœ„ì¹˜ë¥¼ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•´ ë³´ì„¸ìš”!")
Â  Â Â 
with col_map:
Â  Â  st.subheader(f"ğŸŒ {selected_country} ì§€ë„ ì´ë¯¸ì§€")
Â  Â  # ì§€ë„ ì´ë¯¸ì§€ íƒœê·¸ ì¶”ê°€ (ì‚¬ìš©ì ìš”ì²­ ë°˜ì˜)
Â  Â  st.markdown(f"")

st.markdown("---")
st.markdown("Â© 2025 SafeTrip Assistant")
